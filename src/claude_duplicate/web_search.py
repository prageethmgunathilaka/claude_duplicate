import requests
from typing import Dict, List

class WebSearch:
    def __init__(self, api_key: str):
        self.api_key = api_key
        self.base_url = "https://api.brave.com/search"

    def search(self, query: str, max_results: int = 5) -> List[Dict]:
        headers = {
            "Authorization": f"Bearer {self.api_key}"
        }
        params = {
            "q": query,
            "count": max_results
        }

        response = requests.get(
            self.base_url,
            headers=headers,
            params=params
        )
        response.raise_for_status()

        return response.json()["results"]